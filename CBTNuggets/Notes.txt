Information Security: Security and Risk Management
==================================================
==================================================

CIA Concepts
============

CIA: Confidentiality Integrity Availability
Confidentiality: Those who are authorized can see it and work with data. Encrypt it and only authorized people will have keys to decrypt ensuring confidentiality. IPSec
Integrity: No modification to data in transit or rest. Hashing
Availability: Authorized individuals can get to their data. No Denial of Service attacks. Fault tolerant disk system.

Using CIA to apply the correct security solution.

Cyber Crime Terms and Vocabulary
================================

Cyber Threat Actor: Person or entity performing attack

Black Hat: Compromise the system in unlawful way.
White Hat: Ensure security measures are in place and doing their job.
Gray Hat: In the middle of Black and White Hat.
Suicide Hacker: Does not care about their own personal safety, in it for their cause.
Hacktivist: Not as dedicated as suicide hackers, hacktivist do it for cause such as corruption, save the planet etc.
Script Kiddie: Who dont have all the expertise, but can leverage scripts and tools to launch attacks.
Cyber Terrorist: Using expertise for their cause or to perpetrate terrorism.
State Sponsored Hacker: Team or hacker sponsored by team.

Computer Crimes
Cyber Crimes is a broad word for system based and network based crimes
Unlawful access:
In US:
Electronic Communications Privacy Act of 1986
Computer Fraud and Abuse Act 1984
National Information Infrastructure Protection Act of 1996
Wiretap Act

When company compromised, Incident Handling Process comes in action while knowing rules/regulations/laws for IP/Physical Security and then reporting it to federal law agencies(Interpol,FBI,Homeland Security) if needed. Law enforcement agencies catch criminals, its on the company to clean up the breach. If damage is serious enough, DR plan or Business Continuity Plan comes in action.

27000 Series Framework
======================

ISO/IEC 27001 and 27002 ISMS Specifications
ISMS: Information Security Management System
ISO: the International Organisation for Standardization
IEC: the International Electrotechnical Commission
27001: Big Picture, what we should be doing but not specifics on how to. Such as Context of the organisation, Leadership, Planning etc.
27002: Nitty Gritty. Such as HR security, asset management, access control, cryptography etc. 

Due Care and Due Dilligence
===========================
Criminal: You broke a law made by government.
Civil: You harmed another person, disputes between private parties
Due Care: The appropriate level of judgement, prudence, and activity a person should reasonably be expected to have in a given situation
Trade secrets: S/W Code, Secret Sauce etc.
Threats: Reverse Engineer the code is a threat to the S/W company since someone is trying to get on their trade secrets

Due Care: Putting measures in place to protect something.
Due Diligence: Ensuring that those measures remain sufficient to protect that something.

Due Care is applying remediation to an identified vulnerability on an asset, while exercising Due Diligence would be to continue to Penetration Test the asset on a timely basis to ensure the defensive measure applied still works.

Inside Threats and Ethics
=========================
Personnel
Hacker: Wants to know more about the network using hacking tools
Cracker: Mal intent and attempt unlawful access
If CISSP ethics are higher than the company ethics, what should you do? 
=> Whichever is higher, do that
When you should report security vulnerabilities?
Immediately

Policies start with Senior Management
=====================================

Security policies began at Senior Management. Senior Management must endorse and own responsibility of data within the organisation. Senior Management/Owner of the data decides who else can access that data. 
Owner of data classify sensitivity of data such as high, medium, low and unclassified.
Identify critical systems
Regulatory and Legal Compliance
Security objections will be inline with business objectives. Money spent based on classifaction and criticality of data.

Defining Risk
=============

Threat Agent: Takes advantage of a weakness
Vulnerability: Weakness in a system
Risk: The probability of a threat causing loss
Coutermeasure: Compensates for a vulnerabilitiy

Risk Analysis
Quantitative: Evidence Based
Qualitative: Expert or Use Case Scenario Based

You have three risk analysis methods to choose from: qualitative (which uses a risk analysis matrix), quantitative (which uses money or metrics to compute), or hybrid (a combination of qualitative and quantitative but not an answer choice in this scenario). Because the ISP has monitoring and log data, you should use a quantitative approach; it will help quantify the chances of additional customers experiencing a security risk.


To find vulnerabilities, do a co-ordinated penetration testing with a clearly defined SoW.

Control Types
=============

Classify and Reclassify data with time based on sensitivity. Helps reduce costs since you are not CIAing data which is now common knowledge.
Rule of Least Privilege: Give bare minimum access [Confidentiality]
Implement Privileges using Grouping subjects(Role Based Access) It simplifies the provisioning and adminstration rights
Group Objects

Controls of main three types:
Adminstrative Controls[Policies and Procedures, Separation of Duties(One PO and other paying for it), Guys who manage network dont manage the SIEM, Background checks, Security Awareness Training]
Technical Controls[IDS/IPS, Access Control Lists, Authentication, Separate Management Network, Encryption etc.]
Physical Controls [Security Guard, Locked Door, Fence etc.]

Deterrent Controls: Deters attacker
Preventative Controls:Blocks attacker
Detective Controls: Detects attack is happening
Corrective Controls: Recovery

Deterrent frameworks are technology-related and used to discourage malicious activities. For
example, an intrusion prevention system or a firewall would be appropriate in this framework.
There are three other primary control frameworks. A preventative framework helps establish security policies and
security awareness training. A detective framework is focused on finding unauthorized activity in your environment
after a security incident. A corrective framework focuses on activities to get your environment back after a security
incident. There isn’t an assessment framework.

Compliance Requirements
=======================
Based on the data we are housing, regulatory compliance requirements are there. 
SoX Sarbanes Oxley Act for accounting 
HIPPA: Health Data

PCI DSS: Payment Card Industry
Never send any sensitive information in cleartext 
SDLC code reviews
Proper treatment of cookies

What sort of controls?
Based on kind of compliance we are going for.

Disaster Recovery, Business Continuity(BC) and Business Impact Analysis(BIA) 
===========================================================================

Steps to take:
Policy Statement

BIA:
ID ALLCritical Systems
Outage time tolerated
Impact of those systems being down on business
Regulatory Compliance due to being down
Cost/Expense
Dependencies on other systems
Customers
Risks
Assess the potential loss if system is not available to help understand the impact of destructive event
Vulnerability Analysis
Senior people are involved

Security Awareness Training
===========================
Encrypt Disk
No Plain Text Protocols for sensitive information
Social Engineering: For e.g shoulder surfing 
Weakest link: Human factor
Shred paper, Magnetic CDs/DVDs
Sign Security Policy by users every year

Intellectual Property and Licensing
===================================
Copyright: Expression of idea, content, art
Trademarks
Service Marks
Intellectual Property
Licensing: EULA End user license agreement
In Patent you tell how you do something, if it is secret it is more of a trade secret. People who work with or form him will sign NDA/Trade Secret Policy
DMCA Digital Millenium Copyright Act to protect creators and owners of IP
Violation of licensing, report at www.bsa.org

Patent: Protects an invention
Trademark: Protects image or brand
Trade secret: Not fully disclosed to the public 
Copyright: Protects the distribution for the creator
Service Mark: Protects the service

Policy Life Cycle
=================

Develop a policy - Senior Management
High level statements and guidance
Considering regulation/legal requirements while developing policies

Publish the policy

Adopt the policy

Review the policy - Annual, Quarterly etc. 

Funded
Attainable
Reliastic
Adaptable
Enforcable
Implement(Procedures) > Measure it(Standards) > Adaptable
Graphical Repr of Procedures
Flow charts
Guidelines

To verify, information security officer/compliance officer responsibility

Threat Modelling
=================
Identifying potential vulnerabilities and putting countermeasures to mitigate risk

Approaches:
Looking from attacker's perspective [outside or inside]
From architecture perspective
Focus on assets

SIEM Logs : IOC (Indicator of Attack) Recognise Attack befor it happens or as it happening

OSINT: Open source intelligence [shodan, maltego etc.]
ISAC: Information Sharing and Analysis Center: non profit as central resource for threats

Supply Chain Risk Management(SCRM)
============================
what and who? 
What are risks?
BIA + Contingency Plans
Right contracts NDA/Fail to deliver etc. 
Pick vendors who are following certain quality standards(ISO 9001) information security standards(ISO 27001) 
Third party audits AICPA (American Institute of CPAs) and generate SOCs(Service and Organisation control report) 
Standards for doing the reporting. SAS70/SSAE16/SSAE18  Standards for Attestation Engagements (SSAE)
to provide user organizations reasonable assurance that controls at their service organizations, relevant to their internal controls over financial reporting (ICFR) are suitably designed and operating effectively.
Monitoring and Maintaining the relationships

QA
==

Q: You are working on a business continuity project for a company that generates a large amount of content each day for use in social networks. Your team establishes 4 hours as the maximum tolerable data loss in a disaster recovery or business continuity event. In which part of the business continuity plan should you document this?

A: Recovery point objective (RPO)

The RTO establishes the maximum amount of time the organization will be down (or how long it takes to recover), the RPO establishes the maximum data loss that is tolerable, the MTD covers the maximum tolerable downtime




Information Security: Asset Security
====================================
====================================

Classifying assets and information
==================================

FIPS PUB 199 
Federal Information Processing Standards Publication

High Impact
Moderate
Low 

Information type: (C, Impact), (I, Impact), (A, Impact)

Classification National Security Information
Confidentiality has different levels assigned
Confidential: damage
Secret: serious damage
Top Secret: grave damage

Other Data Classifications:

SBU Sensitive but unclassified
SSI Sensitive Security Information
CUI Controlled Unclassified Information

In a non government environment, labels can be:

Protected: SIN, Birthdays etc.
Proprietary: Intellectual Property
Confidential: Only internal use
Public: Free to distribute publicly

Stewards of Assets and Information
==================================

Owner:
Create Policy + Guidance
Assign Values to Asset/Data
Classify the Asset/Data
Authorize Access + Permissions

Custodians:
Implement Contols & Protections based on classifaction and policy
Manage Monitor and Report (Good or Bad)

Assets:
Hardware/Software/Data

Software: 
Software Asset Management(SAM) Program
Document what is in use and where
Audit to verify compliance and licensing
Report + Correct Problems/Violations

Hardware Inventory Management
Document what is in use and where
Track from onboard of hardware all the way to disposal

Configuration Management
Baseline configuration
Change Control all the way

Protecting Privacy
==================

PII: Personally Identifiable Information
SSN, Passport Number etc

PHI Protected Health Information
Only authorized by owners

Regulations and laws require it
GDPR General Data Protection Regulation
HIPAA Health Insurance Portability and Accountability act

The privacy act(PII)
The Cookie Law
Goal: Protect privacy of the user

PIA: Privacy Impact Assessment
what is collected, from whom and why
what are the requirements

PTA: Privacy Threshold Assessment

Gramm-Leach-Billey Act: Financial Information Privacy

Children's online privacy protection act (COPPA)

Data Retention
==============

Archiving - Actively storing to later access the data
Legal hold - A legal hold is a process that an organization uses to preserve all forms of potentially relevant information when litigation is pending or reasonably anticipated.
Legal hold supersedes company's retention policies
Electronic Discovery - refers to discovery in legal proceedings such as litigation, government investigations, or Freedom of Information Act requests, where the information sought is in electronic format (often referred to as electronically stored information or ESI).
FRCP: Federal Rules of Civil Procedure It contails rules of discovery 

To remove date:
wiping
degauze
shred/pulverize,pulping,burning

Certificate of destruction from the company destroying data

Determining Security Controls
=============================

Data Owner - Responsible for oversight, classifaction, controls, access
Done by Directors, Senior Managers etc.

Custodians: Implementation and Monitoring of the security controls
Done by middle managers and team leads

control: intended stragtegy/policy intended to reduce the risk of breach/ negative impact

control functions:
deterrent
preventive
detective 
corrective
compensating

types of controls:
adminstrative: separation of duties, forced vacations etc.
technical/logical controls: access controls 
physical controls: locks

controls should be inline with business objectives (data usable etc.)

encryption: logical control related to confidentiality
data owner: oversight and classifaction guidance
data custodian: the literal implementation of controls
controls: design to reduce or eliminate a vulnerability

Data State and Resources for Security Control Frameworks
========================================================

State of Data: Rest/Transit/Memory

ISO: the International Organisation for Standardization
IEC: the International Electrotechnical Commission
27001: Big Picture, what we should be doing but not specifics on how to. Such as Context of the organisation, Leadership, Planning etc.
27002: Nitty Gritty. Such as HR security, asset management, access control, cryptography etc.

Use NIST guidelines/frameworks

Use FIPS

NSA Rules

Information and Asset Handling Policies
=======================================

Standards -> Baseline (Router, Switch, Firewall, PCs etc.)
Asset Handling Policies -> Communicated to Custodians/Users
Care based on classifaction
If classifaction is proprietary: can it be transmiited, can it stored on mobile, how it is to be destroyed etc.
User Training -> starts with onboarding -> Acceptable use policy sign off -> Annual or semi annual trainings
On top, technical controls to enforce policy for critical data -> DLP, Email Scanning, User agenst acting as watchdog on local devices

Information Security: Security Architecture and Engineering	
===========================================================
===========================================================

Designing with Security in Mind
===============================

Security in the design
Minimize the attack surface - network(ports) applications(calls) 
Baselines- Baseline configuration with security best practices
Secure Tools- Known good tools (weak api)
Rule of least priveleged - just say no - permissions for functionality they need
Defense in depth - Multiple lines of defense NGFW/Antivirus on PCs/ACLs on switches 
Separation of duties - one composing changes, different approver
simplicity - less opportunity for the attacker 

Security Model Fundamentals
===========================

Trustworthy state - Non interference, information flow does not compromise

subject(bob) objects(groups etc.)
Bell-LaPadula Model(Focused on confidentiality): The Bell–LaPadula Model (BLP) is a state machine model used for enforcing access control in government and military applications.

It has: 
The Simple Security Property states that a subject at a given security level may not read an object at a higher security level. - No READ UP
The * (star) Property states that a subject at a given security level may not write to any object at a lower security level. - No WRITE DOWN
The Discretionary Security Property uses an access matrix to specify the discretionary access control.

Biba Model(Focused on Integrity): The Biba Model or Biba Integrity Model developed by Kenneth J. Biba in 1975,[1] is a formal state transition system of computer security policy that describes a set of access control rules designed to ensure data integrity. 

The Simple Integrity Property states that a subject at a given level of integrity must not read data at a lower integrity level (read up or No READ DOWN).
The * (star) Integrity Property states that a subject at a given level of integrity must not write to data at a higher level of integrity (write down or No WRITE UP).
Invocation Property states that a process from below cannot request higher access; only with subjects at an equal or lower level.

Clark-Wilson Model(Focused on Integrity):

Subjects ----------------- Something in the middle to avoid direct access---------------------Objects
Called Access Control Triple

Brewer and Nash Model(Focused on conflict of interest): Focus mitigating conflict of interest 

HRU Harrison, Ruzzo, Ullman Model: focus on integrity of access rights in the system. 

System Security Requirements
============================
Vendors:
Functionality and Assurance that it is going to do what it says it will do. 
Certification and accreditation can be used to assist in creating a trusted computing system. 
TCSEC -> ITSEC -> CC(Common Criteria)[Protection Profile: What we want, Security Target: What we have]

Hardware and Firmware Security Capabilities
===========================================

BIOS Password || UEFI New - Verifies each component before it is ran and Use Secure Boot which verify digital signatures of the code etc.
TPM Trusted Platform Module - Hardware Chips to keep keys, certificates etc.
Encryption on Hard drive - CPU from the CPU or special modules which will take the load HSM Hardware Security Module (For e.g, Cryptography for VPNs using HSMs faster)
CPU Protection Rings - Ring 0 most protected(Kernel) --- Ring3 User games 

Assessing Vulnerabilities
=========================
Client Based/IOT things/Database Systems/Client-Server/Cryptographic Systems etc. etc.
One of the vulnerabilities:
Elevated Priveleges
Service Accounts/Admin accounts only used for intended purpose not daily use
Outdated Software/Firmware/hardware - Inventory
Malware
Remote Access from where to where, requirements, lock it down. If not needed, disable
Documentation and clarity on ownership of the systems
Peer to peer networking

Vulnerabilities in Web Based Systems
====================================
Good H/W and OS
Allow 80 and 443 on firewall to server
TCP intercept on firewall to avoid SYN Flood or other attacks
Host Based IPS
Network Based IPS in the path between server and client
Web Application Firewall - All requests first to WAF, inspects it and send it to the server
Applications need to be secure - Identify top 10 hacks and write code to prevent from them
OWASP: open web application security project 
OWASP Top 10 security risks :

Injection
Broken Authentication
Sensitive Data Exposure
XML External Entities(XEE)
Broken Access Control
Security Misconfiguration
Cross Site Scripting(XSS)
Insecure Deserialization
Using components with known vulnerabilities
Insufficient Logging and Monitoring


Vulnerabilities in Mobile Systems
====================================
Lots of Data
Lots of connectivity options NFC Bluetooth WiFi
Easily Stolen
Mobile policy is important
Onboarding/Offboarding Rules - Data stored, authentication, obligations
Inventory system keeping track of the devices
Remote wipe feature
Enterprise solutions for Mobile - 802.1x authentication, encryption of local data, idle timeout, centrally managing mobile devices to push policies/apps allowed
Hybrid approach, some decisions user can make, other are globally applied and can not be changed

Vulnerabilities in Embedded Devices
====================================
Internet connected
Vulnerability Types:
Progamming mistakes/weakness
Web-base interface vulnerabilities
Missing/weak password - backdoor
older encryption algorithm that can be easily broken

Attack Types:
Hijacking the control plane
Reverse Engineering
Infect with malware
Inject Input into system
Eavesdrop on system and replay the packets
Bruteforce attack if weak cryptography

Inventory as much as you can so that you dont forget during reviews and perform security checks properly.

Facility Design and Controls
============================
Security baked
Defence in layers
fences
bollards
locks
cctv + guard 
sensor types 
coming in/out audit trails
emergency exits/drills/procedures
HVAC
Environmental 
Fire detection and prevention

Symmetric Encryption Concepts
=============================
Same key to encrypt and decrypt
Algorithm e.g DES, 3DES, AES-128,192,256 based on Rjindal Cipher, RC4,RC5,RC6

C-Encrypt
I-Hashing
A-Authentication not Availability


PlainText: Encryption Algorithm + Key : CipherText
CipherText: Encryption Algorithm + Key : PlainText

Transposition: Rearrange bits/characters/blocks of characters to create CipherText
Substitution: Replace with other E.g Caesar cipher Key is n character switch

Symmetric Keys and Algorithms
=============================

Symmetric Key other names: Single Key, Secret Key, Session Key, Shared Key, Private key cryptography.
Preshared Key is not secret key to encrypt actual date. It helps with authentication of source. 

Asymmetric Encryption Concepts
==============================
Key pairs
(K1, K2) created mathematically (publice key, private key)
K1 encypt --> K2 can decrypt
K2 encrypt --> K2 can decrypt
public key share with others
private key keep it private to you
Encrypt using public key, and owner of private key will decrypt it

This protects negotiation of session key 

Famous Implementation: RSA Encryption + Digital Signatures
Asymmetric is slow 
Most data uses symmetric encryption algorithm because of less overhead and fast. Digital signatures and RSA for securely exchanging keys.

Digital Signature Concepts
==========================

Bank server sends digital certificate. 
Bob's computer checks validity date. 
Next, Bob's computer checks if it is signed by trusted certificate authority
If yes, Bob's computer extracts public key and use it to encrypt the data and begin conversation

Bank Server: data --> hash --> Encrypts the hash with private key along with encrypted data --> Encrypted hash is called digital signature 
Bob receives it --> Bob uses sender's public key to decrypt the hash. --> Calculates his own hash on the data 
hash matches with decrypted hash --> Integrity of data and source of data is bank 

digitally sign - non repudiation - bank can't deny it was not me 

CA issues digital certificates to institutions, verifies the authenticity of the institution and takes the public key, create X.509 format certificate and signs it. 
Banks take that certificate and use it on their website
Bob browser has prebuilt list of CAs 
CRL: Certificate Revocation Lists - Certificates retired

Hashing for Integrity
=====================
Speacialized Hardware Based Encryption is faster but more expensive than software based encryption

One way hashing 
Data ===> Hashing ===> Tiny value 
To verify file is not changed run algo and matches the published hash value
Impossible to reverse engineer data from the hash
MD5 SHA-1-160, SHA-256, SHA-384, SHA-512
To avoid MITM, HMAC + secret is used 
hash is calculated with secret in data, and attacker does not know the secret. It helps in validating entity on the other end

Asymmetric Encryption with Email
================================
Email + Hash(Encrypted by Bob's(Sender's) Private Key)

Encrypted Hash: Digital Signature

Receiver:
Decrypt the hash using Sender's public key = Hash
Own hash on the data = Hash
Both hashes should match
Non repudiation

For confidentiality, add encryption 
Use asymmetric key cryptography to set-up session key which will be used for encryption. 
Encrypt Email + Encrypt with Key with other party's public key ==> Send ==> Received ==> Key will be decrypted using private key and then email decrypted
This is basis for PGP Pretty Good Privacy: Asymmetric for key exchange and symmetric for encryption of email and digital signatures

PKI and Revoking Certificates
=============================

PKI:
Issue certificates
Validate certificates
Revoke certificates


If an entity has public/private key pair and they want to put their public key into a digital certificate.

By having a PKI infrastructure, they can go to CA with an enrolment request. CA validates them. Creates the certificate with requestors public key, digitally signs and sends it back to them. 

Since user trusts CA, when certificate signed by CA is presented, user trusts it. 

If public key is compromised, entity notify CA to revoke the certificate

User use either CRLs certificate revocation lists[Download revoked certificate lists] or OCSP Online Certificate Status Protocol [Realtime online check]

Power Considerations
====================
Spike: Momentary rush of power
Surge: Prolonged rush of power
Sag: Short drop in voltage
Browout: Prolonged drop in voltage
Fault: Momentary loss of power
Blackout: Total loss of power 

UPS Uninterruptable Power Supply - Standby unit 
There is little switch over time. To avoid any switchover, people can use Interactive UPS
Redundant UPSs
In DC, A side and B side. UPS 1 to A side and UPS 2 to B side. 
ESD prevention - Use precautions to avoid that static to build, avoid shocks and burnt equipment


Information Security: Communication and Network Security	
===========================================================
===========================================================

OSI and IP Models
=================

OSI
Please do not throw sausage pizza away
Physical Datalink Network Transport Session Presentation Application

DoD TCP/IP:
[Physical]Access [Datalink]Network [Network]Internet [Transport]Host-To-Host [Session Presentation Application]Process/App 

Actual TCP/IP:
Physical(Repeaters/Hubs) Datalink(Switches/Bridges) Network(Routers/FWs) Transport Application(HTTP/DNS)
L4 - Segment
L3 - Packet
L2 - Frame
L1 - Bits

L4 - TCP(Connection Oriented)/UDP(Connection less)
L3 - IP

Better understanding of stack, better protection

IP Networking
=============

When you go to www.google.com -> DNS Request -> ARP -> Routing of the IP via routers and firewalls 

DNS Poisoning
ARP Poisoning 
URL Filtering
Proxy as single point for all traffic and scans to ensure all is good
NGFW IDS/IPS
WAF for incoming traffic to protect servers 
Change control

Wi-Fi Security Considerations
=============================

Concerns with Wi-Fi:

Possibilies of anyone doing reconnaissance
Wardriving: act of searching for Wi-Fi wireless networks by a person usually in a moving vehicle, using a laptop or smartphone.
Network Sniffing
Evil Twin : Impersonating APs
Can be jammed/interfered by rogue devices

Change default passwords as part of baseline configuration
New devices onboarding process , just limiting their L2 MAC. When person/device leaves offboarding
best techniques for auth and encryption 802.11i (WPA2 Enterprise)
Radius server for authentication of Wifi users
802.1x which leverages a supplicant on the devices. This way devices are getting authenticated as well along with users.
For users 2 FA
With 802.1x use certificates
Use good vendors and patch 
Guest users - total separation from corp - capture who they are - temporary token
Wireless IDS/IPS - look for rogue APs/ Triangulate/ Jam rogue APs 
AUP - User trained dont plug any unauthorized devices with proper onboarding process
Physical switch 801.x which supplicant on device that connect
Physical switch ports port security one mac per port

Network Componenet Security
===========================

Wi-Fi Eavesdrop
UTP Cable : Emanation of signal - US Govt codename tempest to studying leak of data from cables, or you can use fibre which has minimal emanation of data
What is connecting into our network - Who we want to allow to connect - only authorized devices - 802.1x, 802.11i traffic encrypted back and forth, certificate for devices
anti malware , firewalls on PCs, NAC agent on computer - compliance on hosts - if not redirect on a vlan to correct the problem
Port Security, Vlans, 802.1x , good logs, change control 
If individual has physical access, it is compromisable - Denial of service, console access, password reset etc.

Virtualized Network Security Considerations
===========================================
 
Change control for users to go and make changes without proper approvals
Users who configure virtual environments can cause huge outages 

Securing Communication Channels
===============================

Face to Face in more secure channel than phone/email etc. 
Sensitive Compartmented Information Facility(SCIF): A Sensitive Compartmented Information Facility (SCIF; pronounced "skiff"), in British and United States military, national security/national defense and intelligence parlance, is an enclosed area within a building that is used to process Sensitive Compartmented Information (SCI) types of classified information.

In networks, challenge protecting confidentiality and integrity.

For data in motion, physical path and logical path. First find types of data, VoIP/Video and Multimedia/Client-Server/Remote Access/Management and Control Protocols

Advice: Make good choices

VoiP - separate vlans, QoS as needed, Encryption as need for important individuals's calls
Remote Desktop - open port on firewall if not, use RDP via a SSL VPN/IPSec 
Wireless - 802.11i WPA2 centralized auth RADIUS, AES no WEP
Management Protocols - SNMP v3 it has authentication, encryption and data integrity 
Routing - OSPF etc with authentication so a new router can be a neighbor without authentication

For connecting to servers, SSH no telnet 
On backend, interfaces between server and server use secure options than plain-text options

To make sure, monitor. Have systems in place to monitor.

Information Security: Identity and Access Management (IAM)	
===========================================================
===========================================================

Identity Management
====================

IM: Controlling user accounts, access and permissions 
Directory Services: Popular Services Active Directory by Microsofy 
Accessed directly or via LDAP. If using LDAP, use secure flavor of LDAP which uses TCP port 636 
Benefits: Ability to single sign-on and access other services such as printer etc. Login one time to domain. 
DS: On prem or off prem 
Robust: There will be some fault tolerance built into it 
In cloud: Identity Management as a service, still single sign on for services 
If single sign on across companies, federated ID management (FIM)
Entities have relationships and trust each other. 
At company B, you can login with other domains/identity providers such as google. 

OpenID Connect: OpenID Connect is a simple identity layer on top of the OAuth 2.0 protocol, which allows computing clients to verify the identity of an end-user based on the authentication performed by an authorization server, as well as to obtain basic profile information about the end-user in an interoperable and REST-like manner.

SAML: Security Assertion Markup Language is an open standard for exchanging authentication and authorization data between parties, in particular, between an identity provider and a service provider.

AAA As Part Of Our Controls
===========================

Subject: Device/Entity making an active request to access an object - Bob the user
Object: File on file server is an object 
If all the middle entities all the transaction, that flow between subject and object is called access 
Access control: It is control whether subject is able to get to the object 
If file server requests to SQL for the data, file server is also a subject. Database record in SQL is object. 
Subject: User, program or process 

Suite of tools to control the access: Logical Access Controls/ Technical Access Controls
How to know who is requesting: AAA Authentication Authorization Accounting 
Authentication: Who you are and then validating. (via e.g Username and Password)
Authentication is a two way street. For e.g bank website, we validate them via digital certificate signed by trusted CA. 
For us, we authenticate via username and password
Both way authentication done

Authorization:What we can do, If we withdraw million dollars they validate if we have that
Accounting: Debit our account for the amount we take out

For Bob, we need to know who Bob is. 
Second, controls in transit, controls on the file read/write permissions for Bob
Third, when bob accessed and what he did. Keeping track 

Centralized Authentication with RADIUS
=======================================

Bob can access the network:
via WiFi [channel security via 802.11i WPA2]
via connect to a LAN port in office [802.1x on the switch, supplicant on Bob device authenticate before allowed to transmit via switch]
from home via SSL VPN [IPSec]
from PSTN via RAS server which has a T1 connection which can accept multiple users over PPP and authenticate via PAP/CHAP 

Where do your store Bob's credentials? AAA Server 
RADIUS: Remote Authentication Dial In User Service RFC 2138 and is an OPEN standard
Devices act as clients, RADIUS server permits/denies the access. 
Bob is client and all devices such as switch, SSL VPN server, Wireless controllers, RAS server etc. are clients

Using LDAP With Directory Services 
==================================

LDAP: Lightweight Directory Access Protocol
Wireless controller acting as LDAP client using LDAP can ask Directory Server if Bob's credentials are good. If yes, it can allow the access.
If lets say VPN server does not support LDAP, it can send RADIUS request to RADIUS server. RADIUS server can act as LDAP client and request Directory Server for the information. and then back.
Integrating services such as AD and Kerberos can improve our management and security of users.
VPN servers and AAA servers are configured in a way that they trust each other. AAA server allow configured devices to come and request for authentication of users.
Same is true for Directory/LDAP server 
Active Directory supports LDAP, hook in using LDAP and not have to create users again in AAA server. 
AAA servers can specify additional details on how and when that user can connect. 
TACACS: Terminal Access Controller Access Control System - Proprietary from Cisco and does what RADIUS does. Not use unless you are in a Cisco environment

Multi-Factor Authentication Categories
======================================
Minimum 8 character, upper and lower case mixed and special characters
Dont share static passwords, never
Basis of multi factor authentication:
HAK: Have, Are, Know - How to verify they are who they say they are 
Know: like PIN of ATM in a bank : via Password - Non-Repudiation
Have: like ATM card in a bank 
Are: World of bio metrics 

Possesion of two from these three, create a multi factor authentication system

Biometric Acceptance and Rejection Rates
=========================================
HAK: Are : Biometrics (Iris scan, Fingerprints etc.) 
It costs money 
Enrollment process to get people in the system 
People might not be willing 
These are barriers to biometrics 
Lets say all enrolled, if somehow system does not recognise them due to some changes to their prints - slow rate of throughput 
More sensitive system is more failure rate -  False Rejection Rate FRR (Type 1)
User might have to try again and again 
Decreasing sensitivity: FAR False Acceptance Rate (Type 2)
Crosspoint is the line where graphs between Number of failures and sensitity for FAR and FER intersect. 
It is called Crossover Error Rate(CER) or Equal Error Rate(EER)
Lower CER better, fine tune system for a lower CER 

Options for Biometric Authentication
====================================

Best to Least:
1. IRIS Recognition: IRIS does not change birth to death
2. Retina Scan: Blood vessels pattern on the retina on the back side of eye
3. Fingerprint Recognition: Ton of details - Absolute identifier - Could be certain portion of the hand
4. Palm Recognition: Hand Recognition/Geometry - some fingerprint information but not in detail - Hand Topography
5. Facial Recognition: Hand close details 
6. Voice Recognition
7. Signature Recognition

DAC, MAC and RBAC
==================
Bob trying to access file1 

MAC: Mandatory Access Control - Just say No - Entire system is managed by rules - rules are done by administrators - Policy created is the Access control for the system 
Clearance levels for user and some sort of classifaction for files, lets say:
TS 
Secret (S)
Classified (C)
Unclassified (U)

Take all objects and put a classifaction on them. And then assign user a clearance.
Then rules by administrators saying lets say anyone with TS can go and read anything on TS and below etc.

Model Examples: 
Bell-LaPadula, No Right Up - No Right Down - Confidentiality
Biba, NRD - NWU - Integrity
Clark-Wilson - Integrity

 For MAC, you need to have an OS that understands that. By default Windows and others are not MAC systems.
 
 DAC: Discretionary Access Control 
 Owner of the data gives access to the data whoever he/she thinks. 
 
 RBAC: Role Based Access Control 
 Centralized Administered Access Rights based on Subjects and Objects mappings 
 Owner does not determine who gets access but a centralized managed access 
 
IAM Provisioning Lifecycle
==========================

4 Phases:
Onboarding - Change control - User Agreements(NDA) - Account Creation - Avoid shared accounts and admin accounts - Individual Accounts initially blank - Orientation 
Authorization and Assignment - Rights/Permissions by owner - Change control - Specific groups assignment according to the role - Security Awareness Training according to groups - SP 800-50 Building a Security Training Program 
Audit/Maintain - Havent been logged in six months (disable inactive accounts) - Auditing on effective permissions(automated) - Permission creep(People change projects and keep permissions from older projects) - Activity of the accounts - Recertification of groups/accounts according to requirements 
Offboarding - Reassign ownership of files and folders 

Information Security: Security Assessment and Testing
======================================================
======================================================

Testing, Auditing, and Assessment Overview
===========================================
For Financial Institutions:
Gramm-Leach-Bliley Act requires financial institutions – companies that offer consumers financial products or services like loans, financial or investment advice, or insurance – to explain their information-sharing practices to their customers and to safeguard sensitive data.

FISMA: Federal Information Security Modernization Act

Payment Card Industry Data Security Standard(PCI DSS) Compliance

Assurance: By performing information security assessment 
We can do via Examination : Take data and look at that, observe, study and compare how it is compared to security baseline and regulations.
We can do via Testing: Injecting something into system - Cause and effect For e.g during scheduled MW do failover checks 

Testing:
Internal: Could be biased since its their baby system, internal staff little friction with external or third party 
External: More unbiased compared to internal
Third Party: More unbiased compared to internal 

Overt communication/agreement/operation: When information about testing is shared with internal teams 
Covert communication/agreement/operation: Like pen testing, where internal teams does not know to find issues

If possible, communicate, educate teams that its best for the business. 

Penetration Testing
====================
Manual
Automatic
Both 

Black Box Testing: Staff knows, Penetration Testing team does not about the system
Double Blind: When neither sides dont knowing
Grey: Both limited information
White: Everyone knows, what if scenarios

Very important in penetration testing: Scope + Permission

Scope: What is allowed to do, devices. For e.g find vuln but do not attack
Passive Recon: Getting information about the target without touching the systems
Active Recon: Monitoring can catch 
Plan + Attack + Exploit 

Reporting: What, how, attacks, vulnerabilities, recommendations 

If major vuln, during testing report right away but to fix, go thru proper change control 

Vulnerability Scans and Assessments
===================================
Trust and Verify
Proactive Verification 
Outdaed software/hardware/OS patches, deviation of policy, what may or may not run
Different compliance requirements, vuln scanner which has plugins for compliance 
Might have agents running on individual systems working in conjunction with scanner, other quick/full scans, open ports , plugins update and vuln databases updates on scanner 
CVE database: Common Vulnerabilities and Exposures 

Reviewing and Testing Code
==========================
Why write own? Security/Customizations
Software should have functionality
Software should be secure 

How to verify, ongoing tests
Static Code Review: line by line check , lots of time, expert
Dynamic: Software behavior when its running, memory calls, testing as good as tool 
Use Case: Security mechanisms and controls are acting properly 
Stress Testing: large number of transaction 
Fuzzing: Invalid inputs, Misuse of the system testing
Regression Testing: Testing after any changes to ensure new changes havent broken the system functionality or introduced any weaknesses. 

Security-Related Data Collection
================================
We can not analyse data that we dont have access to 
An IOC is often described in the forensics world as evidence on a computer that indicates that the security of the network has been breached. 
Unlike Indicators of Compromise (IOCs) used by legacy endpoint detection solutions, indicators of attack (IOA) focus on detecting the intent of what an attacker is trying to accomplish. As a result, next-generation security solutions are moving to an IOA-based approach.

Controls:
Host Based IDS/IPS: On critical servers, only certain applications/processes run, file integrity checking, AV, Anti malware updated, local firewalls stateful nature, policy to avoid removable media, reporting features to report back to centralized location. Someone can monitor activities/events to see anomaly based behavior
Network Devices reporting network/security related behavior and analyzed by software/people 
DLP
NGFW - UTM/IDS/IPS/Intercept of SSL 
WAF: Web application firewall for web servers - stop SQL injection, Cross site scripting - collect this data - analyse and alerts generated 

Logs reported back to cental logging system 

Continuous Monitoring
=====================
Continuous monitoring IOA/IOC 
From National Institute of Standards and Technology: Special Publication SP 800-137 titled Information Security Continuous Monitoring (ISCM) for Federal Information Systems and Organizations

++ ISCM is defined as maintaining ongoing awareness of information security, vulnerabilities and threats to support organizational risk management decisions
++ Six Steps : Define an ISCM stragtegy, Establish an ISCM program, Implement an ISCM program, Analyze data and Report Findings, Respond to findings, Review and Update the ISCM stragtegy and program

If we torture the data long enough, it will tell us anything we want to know. 
Good metrics - Collect data that is relevant and make decisions, frequency of collection, how to report , automated processes, tools doing what we want them to do, review and update the stragtegy

Information Security: Security Operations
=========================================
=========================================

Supporting Investigations
=========================

Do the best you can and follow law,policies and regulations
Preserve evidence 
Fully co-operate with the investigation

Internal/Adminstrative Investigation: e.g employee outside AUP 
Criminal: Crime happened, and govt prosecuting entity or individual (Evidence beyond reasonable doubt)
Civil: Between two parties ( Enough evidence to support alleged claims)
Regulatory: PCI-DSS compliance not followed 

Preserve evidence in all of them 

Fact Witnesses: who saw, heard ,touched something about the case 
Expert Witnesses: with knowledge to give an opinion based on credentials

Types of Evidence
=================

Direct (From 1 or more of Witnesses senses) - Bob saw something with eyes (one of five senses, first hand observer) 
Real/Physical (Tangible Objects) 
Best (Unaltered original contract)
Secondary(Copy of contract)
Conclusive(Very strong on its own): Neighbor complaining you killed his cat, you brought a cat with neighbors cat DNA - conclusive 
Corroborative(Not standalone)
Circumstantial (Deduction/Inference): Bob watched george cut down cherry tree(Bob Testimony - Direct), Lois chatting with George one hour before and told him I am gonna go cut down the cherry tree(Lois testimony - Circumstantial)
Hearsay (Not Firsthand): If Lois told Karen, if Karen called to court her testimony will be hearsay

Chain of Custody
================

Handling the evidence: who collected, how it was collected, how it was labeled, who transported, who recieved, how stored etc. 
Hard-drive: disk image and hashing to document and prove nothing has changed since we collected that hard drive 
If we dont handle chain of custody, evidence may not be admissible in the court 
Evidence Relevant to the case 
If HD formatted, take it to lab and data might be recovered 
If new software build in process, pause it while investigating cyber crimes. Secrets might leak during investigations.

Forensic Process
================

4 Phases: NIST 800-86 Guide to Integrating Forensic Techniques into Incident Response

Collection: preserve integrity, backup of content hashes - use right tools - system running high priority since data is volatile 
Examination: Extracting relevant data from collected data for investigation - 
Analysis: Analyse results of the data extracted during examination
Reporting: action did, tools use, recommendations, how identified to begin with, mitigation techniques to prevent it from happening again 

Separation of Duties
====================

Preventative Adminstrative Control:

Noone should a critical task in a system all by him/herself. Atleast 2
If 4 roles Database Admin, Security Admin, Programmer and Data entry - Bob should give 2 roles to himself 
Data entry & Programmer: He can leave integrity checks and then during data entry he can compromise the system with injection attacks 

Detective Adminstrative Control:

Rotation of Duties
Role X - Bob first six months, then John in the same role , and then Chris 
Trained Backup People 
Cross Training 

Mandatory Vacation:
Bob 2 weeks vacation, Bob wont be able to do his fradulent activty and new person doing the role might detect it 

Two-man control:
Two people to execute - Change Control - Change created by one , Change reviewed by another and then management 
Collusion when both are working together for unauthorized duties 

Media Management
================
Protecting Data at Rest 
Data in Motion: Memory 
Data in Rest: HD

Local Storage
Cloud/Virtualized Storage
Removable (Mobile Devices, USB etc.)

AUP Policies signed by user 

Technical Controls: 
Encrypt: Hardware Based Encryption (Keys, data protected if HW stolen), Software Based Encryption - On files and folders 
Interfaces: Sensitive data - how can a user can connect to access data , cloud what sort of regulations regarding storage of data
Policies on computers to not plug removable media without appropriate access 
If user has elevated priveleges, automated reporting to central logging system 
Trained if they lose a laptop, USB etc etc. 

Backups
=======
Full Backup - Takes time - Weekly - Quicker to Restore
Incremental Backup - Less Time - Faster - Daily 

Restore - Last full and then incrementals 

Differential: The difference in incremental vs. differential backup is that, while an incremental backup only includes the data that has changed since the previous backup, a differential backup contains all of the data that has changed since the last full backup.

SAT - Full
SUN -  Diff 
MON - Diff - Has everything that changed from SAT Full Backup 

Restore with differential is simple than incremental. Full + 1 Differential (With incremental Full + all incrementals since then) 
All incrementals are needed for restore. With differential, you need full and latest differential.

Backup Types: 
8mm
DLT - (Super DLT) digital linear tape

Rotation cycle: Move the media to a different location, if backups disks are where the gear is being backed up 
Remote backups now , where DC is one city and Backup facility in another. 
An optical jukebox is a robotic data storage device that can automatically load and unload optical discs, such as Compact Disc, DVD, Ultra Density Optical or Blu-ray disc and can provide terabytes (TB) and petabytes (PB) of tertiary storage. 
Backup priority and safetly similar to the data stored on them. Important data with better backup measures, correctly labeled, clearance for people moving that data.

Logging With Separation Of Duties
=================================
Bob, Sys Admin, all accounting logs to Log Server 
Bob at the most real only access so that he cant modify logs in case he goes rogue 
Roles: Identification -> Authentication -> Make changes -> Log Accountability
Centralized time service for accurate time stamps on logs 
What to log - Significant events for devices - Reboots, Config Changes, Encrypt as sending to log server, Failed logins (5 in 60s flag, block time to prevent brute force time), Password Changes as per policy
Restrict Bob cant disable logging, access control 
Retention Policy: Logs for 3 years, data older 3 years purge - automatic or manual - we are not liable for logs older than retention policy

RAID Concepts
=============

Levels:
0: 2 Disks - 1 TB + 1 TB - Appear as 2 TB drive - Good for speed but no fault tolerance
1: 2 Disks - 1 TB + 1 TB - Appear as 1 TB drive - Mirroring writing table - Fault Tolerance 
2
3
4
5: Some brain CPU: In RAID solutions harware solution which takes care of that instead of passing it to CPU Multiple lets say 5 Disks - 1 TB each - Appear as 4 TB - Data will be allocated in a way that you can lose one disk without data loss 
10: Minimum 4 Disks: RAID 0 on 2 sets doing RAID 1 of two disks - Mirrored + Striped across multiple drives 

Hardware solution faster than software solution 

Incident Response Overview
==========================
SPR: Stimulus Pause Response 
Events vs Incidents: 
Events: Email sent, SSH to server 
Security Incident: Compromise to CIA, service, phishing attacks, peer to peer networking exfiltrate data 
More prepared, better we are to contain the risk 

NIST 800 Series - Special Publication SP 800-61 Rev 2 Computer Security Incident Handling Guide
3 Ps
Policy for Incident Handling : On Senior Management - Purpose Objectives Scope Definition Priority/Severity of Incidents 
Plan based on Policy: Roadmap - Metrics around implementation - Mission 
Procedures based on Policy and Plan - Details of technical processes, checklists etc. during Incident Handling

Phases of Incident Handling
===========================
Preparation: Based on Policy and Plan, creating IRT, Tools, Resources to handle incident. Controls to mitigate and reduce the risk 
Detection and Analysis: Apply prep
Containment Eractication and Recovery: Contain incident based on prep, go back to Detection and Analysis to ensure other systems are not impacted
Post Incident Activity : Reports - cause, cost and steps for future and learn from incident. Communicating report as per IR plan,educate as needed 

Improving Security With Configuration Management
================================================
Identify Devices similar in nature
Build Baseline configurations
CI(Configuration Item) -> BC(Baseline Configuration)
Baseline: 
Switch:
No telnet 
All ports by default bogus vlan 999

New element to include in BC -> Test , validate -> Update BC -> Update Library when configurations are stored -> BC Version Control 
If config changes -> Constant monitoring -> Via change control go back and apply new BC 
If change is going on all switches -> Asset inventory and device information -> Configuration Management Database

Patch Management
================
Security Patches: High Priority - Expediting way of Change Control - Security Update
Critical Update: Application does not stop 
Functionality/Feature Improvement Update: Dont rush - Not as high priority
Before you apply:
Testing: In non prod to ensure it does not affect the system, Regression testing 
Change Control : MW - Detailed rollback process - Document what changes you are doing 
In production environment, windows update scheduled updates, test and then push based on priority, MW and change control 

Change Management
=================

Requests/Drivers: Proactive | Reactive (Security Vuln, Critical Features)
Success 
Minimal Disruption
Harming/Degrading Security 

Documented: Bob CD Drive  
Evaluated/Tested: Only certian vendor, no Write capability for the drive 
Formalized Rollback
CCB Change Control Board - Review the change - Technical Person and Manager and others 
For little things, pre authorize - Standard Changes - still documentation but not reviewed by board 
Critical changes : Emergency change - special procedures in handling critical requests 
identify change window, communicate to involved, implement change, separate parties who creates, approves and implements, updated configuration management database 
Metrics: KPI Key performance indicators, how many come, how many success on first attempt, how many emergencies 






 













































 

























































 






























